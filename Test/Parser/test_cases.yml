test1: |
  START:  LXI H,8000H    ; Load H-L pair with 2000H
          MVI C, 0AH      ; Initialize counter C with 10
          CALL INIT_VALUES; Call subroutine to initialize memory
          CALL SORT       ; Call subroutine to sort data
          HLT             ; Halt the processor

  INIT_VALUES:            ; Subroutine to initialize memory locations
          LXI D, 9000H   ; Load D-E pair with source address 1000H
  INIT_LOOP:              ; Loop to copy values
          MOV M, A        ; Move data from Accumulator to memory pointed by H-L
          INX H           ; Increment H-L pair (destination address)
          INX D           ; Increment D-E pair (source address)
          DCR C           ; Decrement counter C
          JNZ INIT_LOOP   ; Jump back to INIT_LOOP if counter is not zero
          RET             ; Return from subroutine

  SORT:                   ; Subroutine to sort data using bubble sort
          MVI D, 09H      ; Initialize outer loop counter D with 9 (n-1 passes)
  OUTER:  LXI H, 2000H    ; Point H-L to the start of the array for each pass
          MVI E, 09H      ; Initialize inner loop counter E with 9 (n-1 comparisons)
  INNER :  MOV A, M        ; Load current element into Accumulator
          INX H           ; Point to the next element
          CMP M           ; Compare Accumulator with the next element
          JC SKIP         ; If A < M (no swap needed), jump to SKIP
          MOV B, M        ; Swap elements: Store M in B
          MOV M, A        ; Move A to M (current location)
          DCX H           ; Point back to the previous element
          MOV M, B        ; Move B (original next element) to M (previous location)
          INX H           ; Point back to the next element position for loop continuation
  SKIP :   DCR E           ; Decrement inner loop counter
          JNZ INNER       ; Jump back to INNER if not zero
          DCR D           ; Decrement outer loop counter
          JNZ OUTER       ; Jump back to OUTER if not zero
          RET             ; Return from subroutine

test2: |
  START:  LXI H, 3000H      ; Load starting address of data
    MVI C, 0AH         ; Counter = 10 (10 bytes to add)
    MVI A, 00H         ; Clear accumulator (for sum)
    CALL ADD_LOOP      ; Call subroutine to add bytes
    CALL STORE_RESULT  ; Store the result at 3050H
    HLT                ; Stop execution

  ADD_LOOP: 
    MOV B, M           ; Load memory data into B
    ADD B              ; Add B to accumulator
    INX H              ; Move to next memory location
    DCR C              ; Decrease counter
    JNZ ADD_LOOP       ; Continue until counter = 0
    RET                ; Return to main program

  STORE_RESULT:
    LXI H, 3050H       ; Load result memory address
    MOV M, A           ; Store final sum
    RET                ; Return to main program

test3: |
  LXI H, 3000H      ; Load starting address of data
    MVI C, 0AH         ; Counter = 10 (10 bytes to add)
    MVI A, 00H         ; Clear accumulator (for sum)
    CALL ADD_LOOP      ; Call subroutine to add bytes
    CALL STORE_RESULT  ; Store the result at 3050H
    HLT                ; Stop execution

  ADD_LOOP: 
    MOV B, M           ; Load memory data into B
    ADD B              ; Add B to accumulator
    INX H              ; Move to next memory location
    DCR C              ; Decrease counter
    JNZ ADD_LOOP       ; Continue until counter = 0
    RET                ; Return to main program

  STORE_RESULT:
    LXI H, 3050H       ; Load result memory address
    MOV M, A           ; Store final sum
    RET                ; Return to main program

test4: |
  ; Program to confuse parser
  INIT:   MVI A, 00H ; initialize A
  ;LOOP START
  LOOP1:  INR A  ; increase A: register
          JZ LOOP2 ; jump if zero
          JMP LOOP1 ; back to LOOP1
          ;LOOP2 is below
  LOOP2:  MVI B, 0AH ; load B=10
          OUT:  MOV C, A ; OUT is a label, not instruction
          JMP OUTPUT ; jump to OUTPUT
  OUTPUT: HLT ; Stop program
          : MVI D, 00H ; stray colon line to break parser
  NOP: NOP  NOP: NOP ; two labels in one line
  ; Extra comment: this line: has colon;
          MOV A, B ; normal line

test5: |
  XLI H, 3000H      ; Load starting address of data
  MVI C, 0AH         ; Counter = 10 (10 bytes to add)

  MVI A, 00H ; Clear accumulator (for sum)
  CALL ADD_LOOP      ; Call subroutine to add bytes
  CALL STORE_RESULT  ; Store the result at 3050H
  HLT                ; Stop execution

test0: |
 START:
 MOV A,B
 MOV C,D
 ADD E
 HLT
 STOP: